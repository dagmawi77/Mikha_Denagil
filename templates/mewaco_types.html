{% extends "base.html" %}

{% block title %}MEWACO Types - የመዋጮ አይነቶች{% endblock %}

{% block content %}
<style>
    .mewaco-header {
        background: linear-gradient(135deg, #14860C 0%, #106b09 100%);
        color: white;
        padding: 2rem;
        border-radius: 15px;
        margin-bottom: 2rem;
        box-shadow: 0 10px 30px rgba(20, 134, 12, 0.2);
    }
    
    .stat-card {
        background: white;
        border-radius: 12px;
        padding: 1.5rem;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
    }
    
    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    }
    
    .stat-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: #14860C;
    }
</style>

<div class="container-fluid">
    <!-- Header -->
    <div class="mewaco-header">
        <div class="row align-items-center">
            <div class="col-md-10">
                <h2 class="mb-2"><i class="fa fa-money me-3"></i>የመዋጮ አይነቶች - Contribution Types</h2>
                <p class="mb-0" style="opacity: 0.9;">Manage contribution categories and default amounts</p>
            </div>
        </div>
    </div>
    
    <!-- Statistics Cards -->
    <div class="row g-3 mb-4">
        <div class="col-md-4">
            <div class="stat-card">
                <div class="stat-number">{{ type_stats.total_types }}</div>
                <div class="stat-label">Total Types<br>ጠቅላላ አይነቶች</div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="stat-card">
                <div class="stat-number" style="color: #28a745;">{{ type_stats.active_types }}</div>
                <div class="stat-label">Active Types<br>ንቁ አይነቶች</div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="stat-card">
                <div class="stat-number" style="color: #17a2b8;">{{ type_stats.total_default }}</div>
                <div class="stat-label">Total Default Amount<br>ጠቅላላ መደበኛ መጠን (Birr)</div>
            </div>
        </div>
    </div>
    
    <!-- Add/Edit Form -->
    <div class="book-form-card mb-4">
        <h4 class="mb-4" style="color: #14860C; font-weight: 700;">
            <i class="fa fa-plus-circle me-2"></i>
            {% if type_data %}Edit Type - አይነት ማረም{% else %}Add New Type - አዲስ አይነት መመዝገቢያ{% endif %}
        </h4>
        
        <form method="POST" id="typeForm">
            <input type="hidden" name="id" value="{{ type_data.id or '' }}">
            <input type="hidden" name="action" value="{% if type_data %}edit{% else %}add{% endif %}">
            
            <div class="row g-3">
                <div class="col-md-6">
                    <label class="form-label fw-bold">Type Name / የአይነት ስም <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="type_name" value="{{ type_data.type_name or '' }}" required placeholder="e.g., General Monthly Contribution">
                </div>
                
                <div class="col-md-3">
                    <label class="form-label fw-bold">Default Amount / መደበኛ መጠን (Birr) <span class="text-danger">*</span></label>
                    <input type="number" class="form-control" name="default_amount" value="{{ type_data.default_amount or '' }}" step="0.01" min="0" required placeholder="200.00">
                </div>
                
                <div class="col-md-3">
                    <label class="form-label fw-bold">Status / ሁኔታ</label>
                    <select class="form-control" name="status">
                        <option value="Active" {% if not type_data or type_data.status == 'Active' %}selected{% endif %}>Active - ንቁ</option>
                        <option value="Inactive" {% if type_data and type_data.status == 'Inactive' %}selected{% endif %}>Inactive - ቀዝቃዛ</option>
                    </select>
                </div>
                
                <div class="col-md-12">
                    <label class="form-label fw-bold">Description / መግለጫ</label>
                    <textarea class="form-control" name="description" rows="2" placeholder="Brief description of this contribution type...">{{ type_data.description or '' }}</textarea>
                </div>
                
                <div class="col-md-12 text-end">
                    {% if type_data %}
                    <a href="{{ url_for('mewaco_types') }}" class="btn btn-secondary me-2" style="border-radius: 10px;">
                        <i class="fa fa-times me-2"></i>Cancel
                    </a>
                    {% endif %}
                    <button type="submit" class="btn btn-success">
                        <i class="fa fa-save me-2"></i>{% if type_data %}Update Type{% else %}Add Type{% endif %}
                    </button>
                </div>
            </div>
        </form>
    </div>
    
    <!-- Types Table -->
    <div class="book-table-card">
        <div class="p-3" style="background: linear-gradient(135deg, #14860C 0%, #106b09 100%);">
            <h4 class="text-white mb-0">
                <i class="fa fa-list me-2"></i>Contribution Types - የመዋጮ አይነቶች
            </h4>
        </div>
        
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Type Name / የአይነት ስም</th>
                        <th>Description / መግለጫ</th>
                        <th>Default Amount / መደበኛ መጠን (Birr)</th>
                        <th>Status / ሁኔታ</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% if types %}
                        {% for type in types %}
                        <tr>
                            <td><strong>{{ type[0] }}</strong></td>
                            <td><strong>{{ type[1] }}</strong></td>
                            <td>{{ type[2] or '-' }}</td>
                            <td><strong style="color: #14860C;">{{ "%.2f"|format(type[3]) }} Birr</strong></td>
                            <td>
                                {% if type[4] == 'Active' %}
                                <span class="badge bg-success">{{ type[4] }}</span>
                                {% else %}
                                <span class="badge bg-secondary">{{ type[4] }}</span>
                                {% endif %}
                            </td>
                            <td style="white-space: nowrap;">
                                <a href="?edit_id={{ type[0] }}" class="btn btn-sm btn-primary action-btn" title="Edit">
                                    <i class="fa fa-edit"></i>
                                </a>
                                <form method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this contribution type?');">
                                    <input type="hidden" name="id" value="{{ type[0] }}">
                                    <input type="hidden" name="action" value="delete">
                                    <button type="submit" class="btn btn-sm btn-danger action-btn" title="Delete">
                                        <i class="fa fa-trash"></i>
                                    </button>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="6" class="text-center py-5">
                                <i class="fa fa-money fa-3x text-muted mb-3" style="display: block;"></i>
                                <h5 class="text-muted">No contribution types found</h5>
                                <p class="text-muted">Add your first contribution type to get started</p>
                            </td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // Smooth scroll to form when editing
    {% if type_data %}
    window.addEventListener('load', function() {
        document.getElementById('typeForm').scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
    {% endif %}
</script>

{% endblock %}


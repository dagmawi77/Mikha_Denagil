{% extends "base.html" %}

{% block content %}
<style>
    .career-container { background: #f8f9fa; min-height: 100vh; padding: 30px; }
    .page-header { background: linear-gradient(135deg, #14860C 0%, #106b09 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; }
    .member-info-card { background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 2px 15px rgba(0,0,0,0.08); }
    .member-photo { width: 100px; height: 100px; border-radius: 50%; background: #14860C; color: white; display: flex; align-items: center; justify-content: center; font-size: 40px; font-weight: 700; }
    .stats-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
    .stat-card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); border-left: 4px solid #14860C; }
    .stat-card .value { font-size: 32px; font-weight: 700; color: #2c3e50; }
    .stat-card .label { font-size: 14px; color: #6c757d; font-weight: 600; }
    .modern-card { background: white; border-radius: 15px; box-shadow: 0 2px 15px rgba(0,0,0,0.08); margin-bottom: 30px; }
    .modern-card .card-header { background: linear-gradient(135deg, #14860C 0%, #106b09 100%); color: white; padding: 20px 30px; }
    .modern-card .card-body { padding: 30px; }
    .timeline { position: relative; padding-left: 40px; }
    .timeline-item { position: relative; padding-bottom: 30px; border-left: 3px solid #e9ecef; }
    .timeline-item:last-child { border-left: 3px solid transparent; }
    .timeline-marker { position: absolute; left: -12px; width: 20px; height: 20px; border-radius: 50%; background: #14860C; border: 3px solid white; }
    .timeline-marker.current { background: #ffc107; animation: pulse 2s infinite; }
    .timeline-marker.leadership { background: #dc3545; }
    .timeline-content { padding-left: 30px; }
    .timeline-date { font-size: 12px; color: #6c757d; font-weight: 600; }
    .timeline-title { font-size: 18px; font-weight: 700; color: #2c3e50; margin: 5px 0; }
    .timeline-subtitle { font-size: 14px; color: #6c757d; }
    .position-badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600; margin-right: 5px; }
    .badge-current { background: #28a745; color: white; }
    .badge-past { background: #6c757d; color: white; }
    .badge-leadership { background: #dc3545; color: white; }
    .badge-regular { background: #17a2b8; color: white; }
    .position-card { border: 2px solid #e9ecef; border-radius: 10px; padding: 20px; margin-bottom: 15px; }
    .position-card.current { border-color: #28a745; background: #f8fff8; }
    .position-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .duration-badge { background: #6c757d; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; }
    
    @keyframes pulse {
        0%, 100% { box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.7); }
        50% { box-shadow: 0 0 0 10px rgba(255, 193, 7, 0); }
    }
</style>

<div class="career-container">
    <div class="page-header">
        <h2><i class="icon-briefcase"></i> Member Career History / የአባል የሥራ ታሪክ</h2>
        <p>Complete position and department leadership history</p>
    </div>
    
    <!-- Member Info Card -->
    <div class="member-info-card">
        <div class="row">
            <div class="col-md-2 text-center">
                <div class="member-photo">{{ member[1][0] }}</div>
            </div>
            <div class="col-md-10">
                <h3>{{ member[1] }}</h3>
                <p><strong>Section:</strong> {{ member[2] }} | <strong>Phone:</strong> {{ member[3] }} | <strong>Gender:</strong> {{ member[5] }}</p>
                <a href="{{ url_for('manage_members') }}" class="btn btn-sm btn-secondary"><i class="icon-arrow-left"></i> Back to Members</a>
            </div>
        </div>
    </div>
    
    <!-- Statistics -->
    <div class="stats-row">
        <div class="stat-card">
            <div class="label">Total Positions Held</div>
            <div class="value">{{ total_positions }}</div>
        </div>
        <div class="stat-card">
            <div class="label">Leadership Roles</div>
            <div class="value">{{ leadership_count }}</div>
        </div>
        <div class="stat-card">
            <div class="label">Days of Service</div>
            <div class="value">{{ total_service_days }}</div>
        </div>
        <div class="stat-card">
            <div class="label">Current Positions</div>
            <div class="value">{{ current_positions|length }}</div>
        </div>
    </div>
    
    <!-- Current Positions -->
    {% if current_positions %}
    <div class="modern-card">
        <div class="card-header">
            <h4><i class="icon-star"></i> Current Positions</h4>
        </div>
        <div class="card-body">
            {% for pos in current_positions %}
            <div class="position-card current">
                <div class="position-header">
                    <div>
                        <h5>{{ pos[1] }}</h5>
                        <span class="badge-current position-badge">CURRENT</span>
                        {% if pos[6] %}<span class="badge-leadership position-badge">LEADERSHIP</span>{% endif %}
                        <span class="badge-regular position-badge">{{ pos[7] or 'Regular' }}</span>
                    </div>
                </div>
                <p><strong>Department:</strong> {{ pos[2] or 'N/A' }}</p>
                <p><strong>Level:</strong> {{ pos[5] }}</p>
                <p><strong>Started:</strong> {{ pos[3] }}</p>
                <p><strong>Appointment Type:</strong> {{ pos[4] }}</p>
                {% if pos[8] %}<p><strong>Notes:</strong> {{ pos[8] }}</p>{% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- Department Head History -->
    {% if dept_head_history %}
    <div class="modern-card">
        <div class="card-header">
            <h4><i class="icon-organization"></i> Department Head History</h4>
        </div>
        <div class="card-body">
            {% for dh in dept_head_history %}
            <div class="position-card {% if dh[6] %}current{% endif %}">
                <div class="position-header">
                    <div>
                        <h5>Head of {{ dh[1] }}</h5>
                        {% if dh[6] %}
                            <span class="badge-current position-badge">CURRENT</span>
                        {% else %}
                            <span class="badge-past position-badge">PAST</span>
                        {% endif %}
                        <span class="badge-leadership position-badge">DEPT HEAD</span>
                    </div>
                    <div class="duration-badge">
                        {{ (dh[7] / 365)|round(1) }} years
                    </div>
                </div>
                <p><strong>Started:</strong> {{ dh[2] }}</p>
                {% if dh[3] %}<p><strong>Ended:</strong> {{ dh[3] }}</p>{% endif %}
                {% if dh[4] %}<p><strong>Appointment Reason:</strong> {{ dh[4] }}</p>{% endif %}
                {% if dh[5] %}<p><strong>Termination Reason:</strong> {{ dh[5] }}</p>{% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- Position History -->
    {% if position_history %}
    <div class="modern-card">
        <div class="card-header">
            <h4><i class="icon-clock"></i> Position History</h4>
        </div>
        <div class="card-body">
            {% for pos in position_history %}
            <div class="position-card">
                <div class="position-header">
                    <div>
                        <h5>{{ pos[1] }}</h5>
                        <span class="badge-past position-badge">PAST</span>
                        {% if pos[7] %}<span class="badge-leadership position-badge">LEADERSHIP</span>{% endif %}
                        <span class="badge-regular position-badge">{{ pos[8] or 'Regular' }}</span>
                    </div>
                    <div class="duration-badge">
                        {{ (pos[10] / 365)|round(1) }} years
                    </div>
                </div>
                <p><strong>Department:</strong> {{ pos[2] or 'N/A' }}</p>
                <p><strong>Level:</strong> {{ pos[6] }}</p>
                <p><strong>Period:</strong> {{ pos[3] }} to {{ pos[4] }}</p>
                <p><strong>Appointment Type:</strong> {{ pos[5] }}</p>
                {% if pos[9] %}<p><strong>Notes:</strong> {{ pos[9] }}</p>{% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- Timeline View -->
    <div class="modern-card">
        <div class="card-header">
            <h4><i class="icon-graph"></i> Career Timeline</h4>
        </div>
        <div class="card-body">
            <div class="timeline">
                {% for item in timeline %}
                <div class="timeline-item">
                    <div class="timeline-marker {% if item[5] %}current{% endif %} {% if item[6] %}leadership{% endif %}"></div>
                    <div class="timeline-content">
                        <div class="timeline-date">
                            {{ item[3] }} {% if item[4] %}to {{ item[4] }}{% else %}to Present{% endif %}
                        </div>
                        <div class="timeline-title">
                            {% if item[0] == 'Dept Head' %}
                                <i class="icon-organization"></i> Department Head: {{ item[1] }}
                            {% else %}
                                <i class="icon-briefcase"></i> {{ item[1] }}
                            {% endif %}
                        </div>
                        <div class="timeline-subtitle">
                            {% if item[2] %}{{ item[2] }} | {% endif %}
                            {% if item[5] %}
                                <span class="badge-current position-badge">CURRENT</span>
                            {% endif %}
                            {% if item[6] %}
                                <span class="badge-leadership position-badge">LEADERSHIP</span>
                            {% endif %}
                        </div>
                        {% if item[7] %}
                            <p style="margin-top: 10px; font-size: 13px; color: #6c757d;">{{ item[7] }}</p>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
